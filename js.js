let isMining = false;
let minedCopper = 0;
let xp = 0;
let level = 1;

// ??????? ??? ?????????? ?????? ?? ????????
function updatePageData() {
    document.getElementById('mined-copper').textContent = minedCopper;
    document.getElementById('xp').textContent = `${xp}/${xp_for_next_level(level)}`;
    const progress = Math.floor((xp / xp_for_next_level(level)) * 100);
    document.getElementById('progress').textContent = `${progress}%`;
    document.getElementById('level').textContent = level;
    document.getElementById('mining-status').textContent = isMining ? 'Mining' : 'Not Mining';
}

// ??????? ??? ?????? ????????
function startMining() {
    if (!isMining) {
        isMining = true;
        updatePageData();

        // ????? ????? ???????? ?????? ??? ???????? ??????? ? ??????? ? ????????? ???????????
        // ????????, ??? ???????? ???????? ??????????? minedCopper ? xp
        setInterval(function () {
            if (isMining) {
                minedCopper += 1;
                xp += 5;
                updatePlayerLevel();
                updatePageData();
            }
        }, 1200); // ???????? ????? ?????????
    }
}

// ??????? ??? ????????? ????????
function stopMining() {
    if (isMining) {
        isMining = false;
        updatePageData();
    }
}

// ??????? ??? ?????????? ????? ??? ?????????? ??????
function xp_for_next_level(current_level) {
    const BASE_XP = 1000;
    const XP_FACTOR = 1.5;
    return BASE_XP * (XP_FACTOR ** (current_level - 1));
}

// ??????? ??? ?????????? ?????? ??????
function updatePlayerLevel() {
    while (xp >= xp_for_next_level(level)) {
        xp -= xp_for_next_level(level);
        level += 1;
        // ????? ????? ???? ?????????????? ???????? ??? ????????? ??????
    }
}

// ??????????? ??????? ??????
document.getElementById('toggle-mining').addEventListener('click', function () {
    if (isMining) {
        stopMining();
    } else {
        startMining();
    }
});

document.getElementById('reload-profile').addEventListener('click', function () {
    // ????? ????? ???????? ?????? ??? ???????????? ??????? ??????
    // ????????, ????????? ?????? ? ??????? ??? ????????? ?????????? ??????
});

// ????????????? ????????
updatePageData();